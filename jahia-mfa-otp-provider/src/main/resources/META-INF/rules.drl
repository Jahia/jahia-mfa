package org.jahia.modules.jahiamfaotpprovider.rules

// list any import classes here.
import org.jahia.services.content.rules.*
import org.jahia.services.content.JCRContentUtils
import org.slf4j.Logger

expander rules.dsl

// declare any global variables here
global User user
global Service service
global Logger logger
global JCRContentUtils jcrUtils


rule "Deactivate MFA OTP when password is updated"
    when
        A property j:password has been set on a node
             - the node has the type jnt:user
    then
        Deactivate MFA OTP for user node
end
